@let url = kcContext.url;
@let messagesPerField = kcContext.messagesPerField;
@let realm = kcContext.realm;
@let auth = kcContext.auth;

<ng-template #headerNode>
  <!-- {{ i18n.msgStr('emailForgotTitle') }} -->
  <div class="leading-tight tracking-tight mb-4">
    <span class="text-lg font-bold">{{ i18n.msgStr('emailForgotTitle') }}</span>
  </div>
</ng-template>
<ng-template #infoNode>
  @let realm = kcContext.realm;
  @if (realm.duplicateEmailsAllowed) {
    {{ i18n.msgStr('emailInstructionUsername') }}
  } @else {
    {{ i18n.msgStr('emailInstruction') }}
  }
</ng-template>

<form
  id="kc-passwd-update-form"
  method="post"
  [kcClass]="'kcFormClass'"
  [action]="url.loginAction"
>
  <div [kcClass]="'kcFormGroupClass'">
    <!-- <div [kcClass]="'kcLabelWrapperClass'">
      <label
        for="password-new"
        [kcClass]="'kcLabelClass'"
      >
        @if (!realm.loginWithEmailAllowed) {
          {{ i18n.msgStr('username') }}
        } @else if (!realm.registrationEmailAsUsername) {
          {{ i18n.msgStr('usernameOrEmail') }}
        } @else {
          {{ i18n.msgStr('email') }}
        }
      </label>
    </div>

    <div [kcClass]="'kcInputWrapperClass'">
      <input
        type="text"
        id="username"
        name="username"
        autofocus
        [kcClass]="'kcInputClass'"
        [attr.aria-invalid]="messagesPerField.existsError('username')"
        [defaultValue]="auth.attemptedUsername ?? ''"
      />

      @if (messagesPerField.existsError('username')) {
        <span
          id="input-error-username"
          aria-live="polite"
          [kcClass]="'kcInputErrorMessageClass'"
          [innerHtml]="messagesPerField.get('username') | kcSanitize: 'html'"
        ></span>
      }
    </div> -->

    <mat-form-field
      appearance="outline"
      class="w-full"
    >
      <mat-label for="username">
        @if (!realm?.loginWithEmailAllowed) {
          {{ i18n.msgStr('username') }}
        } @else if (!realm?.registrationEmailAsUsername) {
          {{ i18n.msgStr('usernameOrEmail') }}
        } @else {
          {{ i18n.msgStr('email') }}
        }
      </mat-label>
      <input
        matInput
        id="username"
        name="username"
        type="text"
        tabindex="2"
        autofocus
        autocomplete="username"
        [defaultValue]="auth.attemptedUsername ?? ''"
        [attr.aria-invalid]="messagesPerField?.existsError('username')"
      />
      @if (messagesPerField?.existsError('username')) {
        <mat-hint class="text-error">
          {{ messagesPerField.getFirstError('username') }}
        </mat-hint>
      }
    </mat-form-field>
  </div>

  <div [kcClass]="['kcFormGroupClass', 'kcFormSettingClass']">
    <!-- <div
      id="kc-form-options"
      [kcClass]="'kcFormOptionsClass'"
    >
      <div [kcClass]="'kcFormOptionsWrapperClass'">
        <span>
          <a
            [href]="url.loginUrl"
            [innerHTML]="i18n.msgStr('backToLogin') | kcSanitize: 'html'"
          ></a>
        </span>
      </div>
    </div> -->

    <a
      class="text-md flex justify-end font-medium text-primary hover:underline"
      [href]="url.loginUrl"
      >{{ i18n.msgStr('backToLogin') }}
    </a>
    <!-- <div
      id="kc-form-buttons"
      [kcClass]="'kcFormButtonsClass'"
    >
      <input
        type="submit"
        [kcClass]="['kcButtonClass', 'kcButtonPrimaryClass', 'kcButtonBlockClass', 'kcButtonLargeClass']"
        [value]="i18n.msgStr('doSubmit')"
      />
    </div> -->

    <button
      name="login"
      class="w-full mt-2"
      type="submit"
      id="kc-login"
      matButton="filled"
    >
      {{ i18n.msgStr('doSubmit') }}
    </button>
  </div>
</form>
